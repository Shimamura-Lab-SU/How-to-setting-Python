# 第3回 演習問題

クラス・関数の定義と使い方について学習しましょう．

## 練習課題

> - [ex3.py](https://github.com/Shimamura-Lab-SU/Sharing-Knowledge-Database/blob/master/python_exercise/03_object_oriented/ex3.py)
> - [ex4_blank.py](https://raw.githubusercontent.com/Shimamura-Lab-SU/Sharing-Knowledge-Database/master/python_exercise/03_object_oriented/ex3_blank.py)

## 演習課題

> - [Problem3.py](https://github.com/Shimamura-Lab-SU/Sharing-Knowledge-Database/blob/master/python_exercise/03_object_oriented/Problem3.py)

演習問題では，画像の雑音除去の雑音除去について勉強しましょう！
下の説明に目を通しつつ，課題に取り組みましょう．

---
## 画像の雑音除去

高感度なセンサで写真や映像を撮影するとき，光量が少ないとどうしてもザラザラとしたノイズが発生します．
これは画像処理分野では「ガウス性白色ノイズ」と呼ばれるもので，画像認識などのバックエンドのアプリケーションに悪い影響を与えます．
そのため，一般にはこのようなアプリのフロントエンドに雑音除去技術が使用されています．
ここでは，雑音除去技術の一つである「**スパース性に基づく画像復元**」を学んでいきましょう．

### 1. DCT基底による画像表現

**フーリエ級数展開**にあるように，あらゆる信号はsin波とcos波の組み合わせ(正確には線形和)で表現できます．下の式にあるように，sin波とcos波，それぞれで基本周波数 `w` が与えられ，その整数倍の周波数 `kw` をもつ波の足し合わせで表現されます．


このフーリエ級数展開による信号の表現は，もちろん画像でも当てはまります．
ある画像の**バッチ**(画像の一部を方形で切り出したもの)を抽出すると，そのバッチは必ず２次元のsin波とcos波の線形和で表現できます．
２次元のsin波とは，横方向(x方向)と横方向(y方向)のそれぞれでsin波の値をもつ２次元データのことで，波面のような構造を持ちます．


さらに興味深いことに，sin波とcos波は互いに位相が90°ずれたものなので，位相をうまく調整すると，実際には２次元cos波のみの線形和で画像を表現することができます．
ただし，正確に画像を表現するにはcos波を無限に用意する必要がありますが(厳密には，周波数 `kw` において k→∞ まで考えないといけないということ)，
これは決して現実的ではありません．
コンピュータで画像を表現するためには，無限のcos波を用いることは避け，多少精度は劣化しても有限個のcos波で表現したいです．

そこで，




### 2. ウィンドウィング (窓関数処理) とオーバーラップ

処理した音声を，もとの連続音声に戻す際に，フレーム間のつなぎ目が不連続になることがあります．
このフレーム間の不連続性を緩和するために，**ウィンドウィング**と**オーバーラップ**を行います．
図はウィンドウィングとオーバーラップの例です．各フレームに両端が滑らかに減衰するハミング窓を書けたあと，処理を加えます．
処理されたフレームは，半分ずつずらして加算(=ハーフオーバーラップ)して連続音声を復元します．

<img src="https://github.com/Shimamura-Lab-SU/Sharing-Knowledge-Database/blob/master/python_exercise/02_IO/processing.png" width="580px">  

### 3. 周波数マスキング

さて，フレーム分割した音声にはどのような処理を加えるのでしょうか？
一つの例として，音声を周波数領域に変換し，いらない周波数成分を取り除くフィルタ処理をよく行います．

下は**周波数マスキング**を使ったフィルタ処理の例です．
まず入力のあるフレーム波形をFFTして複素数周波数スペクトルを算出します．
この複素数周波数スペクトルに対して，各周波数で 0 または 1 の値を設定した**周波数マスク**を用意します．
複素数周波数スペクトルと周波数マスクを互いに掛け合わせて不要な成分をマスキングします．
マスキング後の複素周波数スペクトルをIFFTすることで，処理後のフレーム波形を得ることができます．

<img src="https://github.com/Shimamura-Lab-SU/Sharing-Knowledge-Database/blob/master/python_exercise/02_IO/masking.png" width="670px">  

